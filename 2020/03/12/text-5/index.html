<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
    
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>
    持续集成与持续部署(基础设施搭建） |  Rinz&#39;s Blog
  </title>
  
  <link rel="shortcut icon" href="/logo.png" />
  
  
<link rel="stylesheet" href="/css/style.css">

  
<script src="/js/pace.min.js"></script>


  

  

<meta name="generator" content="Hexo 4.2.0"></head>

</html>

<body>
  <div id="app">
    <main class="content">
      <section class="outer">
  <article id="post-text-5" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h1 class="article-title sea-center" style="border-left:0" itemprop="name">
  持续集成与持续部署(基础设施搭建）
</h1>
  

    </header>
    

    
    <div class="article-meta">
      <a href="/2020/03/12/text-5/" class="article-date">
  <time datetime="2020-03-12T01:21:44.000Z" itemprop="datePublished">2020-03-12</time>
</a>
      
    </div>
    

    
    
    <div class="tocbot"></div>





    

    <div class="article-entry" itemprop="articleBody">
      


      

      
      <h2 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h2><p>构建一套以Jenkins为核心的自动测试与持续集成系统，帮助APP端和服务的进行自动化打包，测试，存储，发布等一系列高度重的任务。</p>
<p>流程: Github上的push操作触发webhook，提送到本地Mac使用ngork反向代理暴露出的Jenkins端口，Jenkins启动自动测试与打包过程，结果通过邮件通知对应开发者，打包完成的ipa，apk，jar等安装包按规则命名存放到指定位置，该位置可以通过本地的nginx服务在局域网内被访问，测试拿到安装包进行手工测试。</p>
<a id="more"></a>

<h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><p>为了满足iOS APP打包需要Mac环境，现在阿里云腾讯云也没有提供Mac OS环境的服务器，所以在本地准备一台Mac环境(例如最便宜的Mac Mini）,在Mac上部署环境。</p>
<h2 id="安装Jenkins"><a href="#安装Jenkins" class="headerlink" title="安装Jenkins"></a>安装Jenkins</h2><p>以下是坑，如果你已经在坑里，可能会帮到你</p>
<p>》》》》》》》》》》》》》》》》》》》》》》》》》》》》》》》》》》》》》》》》》》》<br>从官网下载dmg安装Jenkins<br><a href="https://jenkins.io/download" target="_blank" rel="noopener">the Jenkins download page</a></p>
<p>安装后<br>拿到admin的密码<br>cat /var/log/jenkins/jenkins.log</p>
<p>由于dmg安装后默认建立一个Jenkins用户，无法直接使用本机安装的各项环境，所有需要<br>设置Jenkins权限为当前用户</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 停止Jenkins</span><br><span class="line">sudo launchctl unload &#x2F;Library&#x2F;LaunchDaemons&#x2F;org.jenkins-ci.plist</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 修改Group和User</span><br><span class="line"># &lt;用户名&gt;填写你的MacOS用户名，不知道的可以在命令行使用whoami查看，不需要尖括号</span><br><span class="line">$ sudo vim +1 +&#x2F;daemon +’s&#x2F;daemon&#x2F;staff&#x2F;’ +&#x2F;daemon +’s&#x2F;daemon&#x2F;&lt;用户名&gt; +wq org.jenkins-ci.plist</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 可能相应文件夹的权限</span><br><span class="line">sudo chown -R &lt;用户名&gt;:staff &#x2F;Users&#x2F;Shared&#x2F;Jenkins&#x2F;</span><br><span class="line">sudo chown -R &lt;用户名&gt;:staff &#x2F;var&#x2F;log&#x2F;jenkins&#x2F;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 启动Jenkins</span><br><span class="line">sudo launchctl load &#x2F;Library&#x2F;LaunchDaemons&#x2F;org.jenkins-ci.plist</span><br></pre></td></tr></table></figure>

<p>重启失败产尝试：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo &#x2F;usr&#x2F;bin&#x2F;java -Dfile.encoding&#x3D;UTF-8 -XX:PermSize&#x3D;256m -XX:MaxPermSize&#x3D;512m -Xms256m -Xmx512m -Djava.io.tmpdir&#x3D;&#x2F;Users&#x2F;Shared&#x2F;Jenkins&#x2F;tmp -jar &#x2F;Applications&#x2F;Jenkins&#x2F;jenkins.war --httpPort&#x3D;8080 --enable-future-java</span><br></pre></td></tr></table></figure>
<p>以上都是坑，如果你失败了，是正常的，请放弃dmg安装。</p>
<p>《《《《《《《《《《《《《《《《《《《《《《《《《《《《《《《《《《《《《《《《《《《</p>
<p>使用brew安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install jenkins-lts</span><br></pre></td></tr></table></figure>
<p>如果未安装brew，先安装brew</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ruby -e &quot;$(curl -fsSL https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;Homebrew&#x2F;install&#x2F;master&#x2F;install)”</span><br></pre></td></tr></table></figure>

<p>安装完成</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">To have launchd start jenkins now and restart at login:</span><br><span class="line">  brew services start jenkins-lts</span><br><span class="line">Or, if you don&#39;t want&#x2F;need a background service you can just run:</span><br><span class="line">  jenkins-lts</span><br></pre></td></tr></table></figure>
<p>不要着急启动Jenkins，设置Jenkins的环境配置<br>先去/Library/LaunchDaemons目录下新建一个org.jenkins-ci.plist文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE plist PUBLIC &quot;-&#x2F;&#x2F;Apple&#x2F;&#x2F;DTD PLIST 1.0&#x2F;&#x2F;EN&quot; &quot;http:&#x2F;&#x2F;www.apple.com&#x2F;DTDs&#x2F;PropertyList-1.0.dtd&quot;&gt;</span><br><span class="line">&lt;plist version&#x3D;&quot;1.0&quot;&gt;</span><br><span class="line">  &lt;dict&gt;</span><br><span class="line">    &lt;key&gt;StandardOutPath&lt;&#x2F;key&gt;</span><br><span class="line">    &lt;string&gt;&#x2F;var&#x2F;log&#x2F;jenkins&#x2F;jenkins.log&lt;&#x2F;string&gt;</span><br><span class="line">    &lt;key&gt;StandardErrorPath&lt;&#x2F;key&gt;</span><br><span class="line">    &lt;string&gt;&#x2F;var&#x2F;log&#x2F;jenkins&#x2F;jenkins.log&lt;&#x2F;string&gt;</span><br><span class="line">    &lt;key&gt;EnvironmentVariables&lt;&#x2F;key&gt;</span><br><span class="line">    &lt;dict&gt;</span><br><span class="line">      &lt;key&gt;JENKINS_HOME&lt;&#x2F;key&gt;</span><br><span class="line">      &lt;string&gt;&#x2F;Users&#x2F;&lt;你的目录&gt;&#x2F;Documents&#x2F;FuckingJenkins&#x2F;Jenkins&#x2F;Home&lt;&#x2F;string&gt;</span><br><span class="line">    &lt;&#x2F;dict&gt;</span><br><span class="line">    &lt;key&gt;GroupName&lt;&#x2F;key&gt;</span><br><span class="line">    &lt;string&gt;daemon&lt;&#x2F;string&gt;</span><br><span class="line">    &lt;key&gt;KeepAlive&lt;&#x2F;key&gt;</span><br><span class="line">    &lt;true&#x2F;&gt;</span><br><span class="line">    &lt;key&gt;Label&lt;&#x2F;key&gt;</span><br><span class="line">    &lt;string&gt;org.jenkins-ci&lt;&#x2F;string&gt;</span><br><span class="line">    &lt;key&gt;ProgramArguments&lt;&#x2F;key&gt;</span><br><span class="line">    &lt;array&gt;</span><br><span class="line">      &lt;string&gt;&#x2F;bin&#x2F;bash&lt;&#x2F;string&gt;</span><br><span class="line">      &lt;string&gt;&#x2F;Library&#x2F;Application Support&#x2F;Jenkins&#x2F;jenkins-runner.sh&lt;&#x2F;string&gt;</span><br><span class="line">    &lt;&#x2F;array&gt;</span><br><span class="line">    &lt;key&gt;RunAtLoad&lt;&#x2F;key&gt;</span><br><span class="line">    &lt;true&#x2F;&gt;</span><br><span class="line">    &lt;key&gt;UserName&lt;&#x2F;key&gt;</span><br><span class="line">    &lt;string&gt;jenkins&lt;&#x2F;string&gt;</span><br><span class="line">    &lt;key&gt;SessionCreate&lt;&#x2F;key&gt;</span><br><span class="line">    &lt;true&#x2F;&gt;</span><br><span class="line">  &lt;&#x2F;dict&gt;</span><br><span class="line">&lt;&#x2F;plist&gt;</span><br></pre></td></tr></table></figure>

<p>为避免权限问题，先执行下面的命令行“</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo chown root &#x2F;usr&#x2F;local&#x2F;Cellar&#x2F;jenkins-lts&#x2F;2.204&#x2F;homebrew.mxcl.jenkins.plist</span><br></pre></td></tr></table></figure>

<p>启动</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew services start jenkins-lts</span><br></pre></td></tr></table></figure>

<p>局域网无法访问的问题：<br>修改 homebrew.mxcl.jenkins.plist 的  httpListenAddress 为 0.0.0.0<br>路径:<br>~/Library/LaunchAgents/homebrew.mxcl.jenkins.plist<br>/usr/local/Cellar/jenkins/版本号/homebrew.mxcl.jenkins.plist</p>
<p>重启Jenkins</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew services restart jenkins-lts</span><br></pre></td></tr></table></figure>

<p>启动Jenkins后的设置不再赘述，以下再提几点常见问题</p>
<p><strong>git配置</strong><br>Jenkins-》Manage Jenkins-Global Tool Configuration-》Path to Git executable<br>配置 /usr/local/bin/git</p>
<p>本机git可能保存有默认的用户名密码，这会导致Jenkins在拉取git仓库的时候使用git默认的用户名密码而不是你配置的credit，如果出现git拉取秒挂的问题，可以检查以下这个。</p>
<p><strong>提供一个email notification的template</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset&#x3D;&quot;UTF-8&quot;&gt;</span><br><span class="line">&lt;title&gt;$&#123;PROJECT_NAME&#125;-第$&#123;BUILD_NUMBER&#125;次构建日志&lt;&#x2F;title&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line"> </span><br><span class="line">&lt;body leftmargin&#x3D;&quot;8&quot; marginwidth&#x3D;&quot;0&quot; topmargin&#x3D;&quot;8&quot; marginheight&#x3D;&quot;4&quot;</span><br><span class="line">    offset&#x3D;&quot;0&quot;&gt;</span><br><span class="line">    &lt;table width&#x3D;&quot;95%&quot; cellpadding&#x3D;&quot;0&quot; cellspacing&#x3D;&quot;0&quot;</span><br><span class="line">        style&#x3D;&quot;font-size: 11pt; font-family: Tahoma, Arial, Helvetica, sans-serif&quot;&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;(本邮件是程序自动下发的，请勿回复！)&lt;&#x2F;td&gt;</span><br><span class="line">        &lt;&#x2F;tr&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;&lt;h2&gt;</span><br><span class="line">                    &lt;font color&#x3D;&quot;#0000FF&quot;&gt;构建结果 - $&#123;BUILD_STATUS&#125;&lt;&#x2F;font&gt;</span><br><span class="line">                &lt;&#x2F;h2&gt;&lt;&#x2F;td&gt;</span><br><span class="line">        &lt;&#x2F;tr&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;&lt;br &#x2F;&gt;</span><br><span class="line">            &lt;b&gt;&lt;font color&#x3D;&quot;#0B610B&quot;&gt;构建信息&lt;&#x2F;font&gt;&lt;&#x2F;b&gt;</span><br><span class="line">            &lt;hr size&#x3D;&quot;2&quot; width&#x3D;&quot;100%&quot; align&#x3D;&quot;center&quot; &#x2F;&gt;&lt;&#x2F;td&gt;</span><br><span class="line">        &lt;&#x2F;tr&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;</span><br><span class="line">                &lt;ul&gt;</span><br><span class="line">                    &lt;li&gt;项目名称 ： $&#123;PROJECT_NAME&#125;&lt;&#x2F;li&gt;</span><br><span class="line">                    &lt;li&gt;构建编号 ： 第$&#123;BUILD_NUMBER&#125;次构建&lt;&#x2F;li&gt;</span><br><span class="line">                    &lt;li&gt;触发原因： $&#123;CAUSE&#125;&lt;&#x2F;li&gt;</span><br><span class="line">                    &lt;li&gt;构建日志： &lt;a href&#x3D;&quot;$&#123;BUILD_URL&#125;console&quot;&gt;$&#123;BUILD_URL&#125;console&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;</span><br><span class="line">                    &lt;li&gt;构建  Url ： &lt;a href&#x3D;&quot;$&#123;BUILD_URL&#125;&quot;&gt;$&#123;BUILD_URL&#125;&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;</span><br><span class="line">                    &lt;li&gt;工作目录 ： &lt;a href&#x3D;&quot;$&#123;PROJECT_URL&#125;ws&quot;&gt;$&#123;PROJECT_URL&#125;ws&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;</span><br><span class="line">                    &lt;li&gt;项目  Url ： &lt;a href&#x3D;&quot;$&#123;PROJECT_URL&#125;&quot;&gt;$&#123;PROJECT_URL&#125;&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;</span><br><span class="line">                &lt;&#x2F;ul&gt;</span><br><span class="line">            &lt;&#x2F;td&gt;</span><br><span class="line">        &lt;&#x2F;tr&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;&lt;b&gt;&lt;font color&#x3D;&quot;#0B610B&quot;&gt;Changes Since Last</span><br><span class="line">                        Successful Build:&lt;&#x2F;font&gt;&lt;&#x2F;b&gt;</span><br><span class="line">            &lt;hr size&#x3D;&quot;2&quot; width&#x3D;&quot;100%&quot; align&#x3D;&quot;center&quot; &#x2F;&gt;&lt;&#x2F;td&gt;</span><br><span class="line">        &lt;&#x2F;tr&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;</span><br><span class="line">                &lt;ul&gt;</span><br><span class="line">                    &lt;li&gt;历史变更记录 : &lt;a href&#x3D;&quot;$&#123;PROJECT_URL&#125;changes&quot;&gt;$&#123;PROJECT_URL&#125;changes&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;</span><br><span class="line">                &lt;&#x2F;ul&gt; $&#123;CHANGES_SINCE_LAST_SUCCESS,reverse&#x3D;true, format&#x3D;&quot;Changes for Build #%n:&lt;br &#x2F;&gt;%c&lt;br &#x2F;&gt;&quot;,showPaths&#x3D;true,changesFormat&#x3D;&quot;&lt;pre&gt;[%a]&lt;br &#x2F;&gt;%m&lt;&#x2F;pre&gt;&quot;,pathFormat&#x3D;&quot;    %p&quot;&#125;</span><br><span class="line">            &lt;&#x2F;td&gt;</span><br><span class="line">        &lt;&#x2F;tr&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;&lt;b&gt;Test Informations&lt;&#x2F;b&gt;</span><br><span class="line">            &lt;hr size&#x3D;&quot;2&quot; width&#x3D;&quot;100%&quot; align&#x3D;&quot;center&quot; &#x2F;&gt;&lt;&#x2F;td&gt;</span><br><span class="line">        &lt;&#x2F;tr&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;&lt;pre</span><br><span class="line">                    style&#x3D;&quot;font-size: 11pt; font-family: Tahoma, Arial, Helvetica, sans-serif&quot;&gt;Total:$&#123;TEST_COUNTS,var&#x3D;&quot;total&quot;&#125;,Pass:$&#123;TEST_COUNTS,var&#x3D;&quot;pass&quot;&#125;,Failed:$&#123;TEST_COUNTS,var&#x3D;&quot;fail&quot;&#125;,Skiped:$&#123;TEST_COUNTS,var&#x3D;&quot;skip&quot;&#125;&lt;&#x2F;pre&gt;</span><br><span class="line">                &lt;br &#x2F;&gt;&lt;&#x2F;td&gt;</span><br><span class="line">        &lt;&#x2F;tr&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;&lt;b&gt;&lt;font color&#x3D;&quot;#0B610B&quot;&gt;构建日志 (最后 100行):&lt;&#x2F;font&gt;&lt;&#x2F;b&gt;</span><br><span class="line">            &lt;hr size&#x3D;&quot;2&quot; width&#x3D;&quot;100%&quot; align&#x3D;&quot;center&quot; &#x2F;&gt;&lt;&#x2F;td&gt;</span><br><span class="line">        &lt;&#x2F;tr&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;&lt;textarea cols&#x3D;&quot;80&quot; rows&#x3D;&quot;30&quot; readonly&#x3D;&quot;readonly&quot;</span><br><span class="line">                    style&#x3D;&quot;font-family: Courier New&quot;&gt;$&#123;BUILD_LOG, maxLines&#x3D;100&#125;&lt;&#x2F;textarea&gt;</span><br><span class="line">            &lt;&#x2F;td&gt;</span><br><span class="line">        &lt;&#x2F;tr&gt;</span><br><span class="line">    &lt;&#x2F;table&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<h2 id="安装ngrok"><a href="#安装ngrok" class="headerlink" title="安装ngrok"></a>安装ngrok</h2><p>注册ngrok并获取token，注册后的ngrok将不再有时长限制，不然每次地址会有8小时超时时间</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;ngrok authtoken 1Yexxxxxxxxxxxxx</span><br><span class="line"># 将ngrok设置为后台运行</span><br><span class="line">$ .&#x2F;ngrok authtoken 1YeWcSXbDrM42OdORYay2MaP9bo_7KfXBYZrqkdaSPgRFDbvE</span><br></pre></td></tr></table></figure>

<h2 id="安装fastlane"><a href="#安装fastlane" class="headerlink" title="安装fastlane"></a>安装fastlane</h2><ul>
<li><p>更新ruby<br>首先安装RVM</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -L get.rvm.io | bash -s stable</span><br><span class="line">rvm reinstall 2.6.3</span><br></pre></td></tr></table></figure>
</li>
<li><p>环境设置<br>在Mac OS 10.14 版本以前</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xcode-select --install</span><br></pre></td></tr></table></figure>
<p>在Mac OS 10.14 版本之后</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">open &#x2F;Library&#x2F;Developer&#x2F;CommandLineTools&#x2F;Packages&#x2F;macOS_SDK_headers_for_macOS_10.14.pkg</span><br></pre></td></tr></table></figure></li>
<li><p>安装fastlane</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gem install -n &#x2F;usr&#x2F;local&#x2F;bin fastlane --verbose</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="Github配置"><a href="#Github配置" class="headerlink" title="Github配置"></a>Github配置</h2><p>在项目设置中配置webhooks<br>地址</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;xxxxxxxxxxxx.ngrok.io&#x2F;github-webhook&#x2F;</span><br></pre></td></tr></table></figure>
<p>注意最后面的github-webhook/里面的/一定不要漏掉</p>

      
      <!-- 打赏 -->
      
        <div id="reward-btn">
          打赏
        </div>
        
    </div>
    <footer class="article-footer">
      <a data-url="http://lacusrinz.github.com/2020/03/12/text-5/" data-id="ck7o4eiia0000cwc67lnz90h5"
        class="article-share-link">分享</a>
      
    </footer>

  </div>

  
  
  <nav class="article-nav">
    
    
      <a href="/2020/02/09/ctr/" class="article-nav-link">
        <strong class="article-nav-caption">下一篇</strong>
        <div class="article-nav-title">使用deepCTR库实践</div>
      </a>
    
  </nav>


  

  

  
  
  

</article>
</section>
      <footer class="footer">
  <div class="outer">
    <ul class="list-inline">
      <li>
        &copy;
        2020
        Lacus Rinz
      </li>
      <li>
        
          Powered by
        
        
        <a href="https://hexo.io" target="_blank">Hexo</a> Theme <a href="https://github.com/Shen-Yu/hexo-theme-ayer" target="_blank">Ayer</a>
        
      </li>
    </ul>
    <ul class="list-inline">
      <li>
        
        
        <ul class="list-inline">
  <li>PV:<span id="busuanzi_value_page_pv"></span></li>
  <li>UV:<span id="busuanzi_value_site_uv"></span></li>
</ul>
        
      </li>
      <li>
        <!-- cnzz统计 -->
        
      </li>
    </ul>
  </div>
</footer>
    <div class="to_top">
        <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>
      </div>
    </main>
    
    <aside class="sidebar">
      
        <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/logo.png" alt="Rinz&#39;s Blog"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">目录</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
      </aside>
      <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="/images/alipay.jpg">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="/images/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
      
<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/jquery.justifiedGallery.min.js"></script>


<script src="/js/lazyload.min.js"></script>


<script src="/js/busuanzi-2.3.pure.min.js"></script>




  
<script src="/js/tocbot.min.js"></script>

  <script>
    // Tocbot_v4.7.0  http://tscanlin.github.io/tocbot/
    tocbot.init({
      tocSelector: '.tocbot',
      contentSelector: '.article-entry',
      headingSelector: 'h1, h2, h3, h4, h5, h6',
      hasInnerContainers: true,
      scrollSmooth: true,
      positionFixedSelector: '.tocbot',
      positionFixedClass: 'is-position-fixed',
      fixedSidebarOffset: 'auto',
    });
  </script>


<script>
  var ayerConfig = {
    mathjax: false
  }
</script>


<script src="/js/ayer.js"></script>


<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css">



<script type="text/javascript" src="https://js.users.51.la/20544303.js"></script>
  
  
  </div>
</body>

</html>